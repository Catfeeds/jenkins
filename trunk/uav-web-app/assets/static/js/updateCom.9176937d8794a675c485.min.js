webpackJsonp([13,34,36,37],{22:function(e,t){"use strict";function a(e){return("00"+e).substr(e.length)}function n(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var o in n)if(new RegExp("("+o+")").test(t)){var s=n[o]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?s:a(s))}return t}function o(e,t,a,n){var o,s,r;r=6371,t=t*Math.PI/180,n=n*Math.PI/180,o=t-n,s=(e-a)*Math.PI/180;var i,l,c;return l=Math.sin(o/2),c=Math.sin(s/2),i=2*r*Math.asin(Math.sqrt(l*l+Math.cos(t)*Math.cos(n)*c*c))}Object.defineProperty(t,"__esModule",{value:!0}),t.default={formatDate:n,distance:o}},103:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n=[3,7,9,10,5,8,4,2],o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","T","U","W","X","Y"],s=[1,3,9,27,19,26,16,17,20,29,25,13,8,24,10,30,28],r=function(e,t,a,n){for(var o=0,s=0;s<a.length;s++){var r=e[s];o+=a[s]*t.indexOf(r)}return n-o%n},i=function(e){var t=e.toUpperCase();if(18!=t.length)return!1;var i=/^\w\w\d{6}\w{9}\w$/;if(!i.test(t))return!1;if(i=/^[1,5,9,Y]\w\d{6}\w{9}\w$/,!i.test(t))return!1;if(i=/^(11|12|13|19|51|52|53|59|91|92|93|Y1)\d{6}\w{9}\w$/,!i.test(t))return!1;if(i=/^(11|12|13|19|51|52|53|59|91|92|93|Y1)\d{6}\w{9}\w$/,!i.test(t))return!1;var l,c=r(t.substr(8),a,n,11);if(c<10&&(l=c),10==c?l="X":11==c&&(l="0"),l!=t.substr(16,1))return!1;var m=r(t,o,s,31),p=o[m];if(void 0==p||p!=t.substr(17,1))return!1;var u=t.substr(0,16)+l+p;return t==u};t.default=i},253:function(e,t,a){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(61),s=n(o),r=a(8),i=n(r),l=a(12),c=n(l),m=a(22),p=(n(m),a(103)),u=n(p);t.default={methods:{checklicenseNumber:function(){if(""!=this.company.licenseNumber){var t=this;e.ajax({type:"POST",url:i.default.CHECK_USERNAME,data:{data:this.company.licenseNumber,type:5},success:function(){},error:function(){t.company.licenseNumber=""},dataType:"json"})}},checkTel:function(){if(""==this.company.newPhone||11!=this.company.newPhone.length)return this.$message.error("请填写正确手机号");if(this.company.emergencyContactPhone==this.company.newPhone)return this.company.newPhone="",this.$message.error("新注册号码不能与紧急联系人号码一致");var t=this;e.ajax({type:"POST",url:i.default.CHECK_USERNAME,data:{data:this.company.newPhone,type:1},success:function(){function e(){n--,t.timeback=n,n<=0&&(t.tongyi=!0,clearInterval(a))}clearInterval(a);var a=null;t.tongyi=!1,a=setInterval(e,1e3);var n=60},error:function(){t.company.newPhone=""},dataType:"json"});var a=i.default.GET_MESSAGW+t.company.newPhone;e.ajax({type:"GET",url:a,success:function(e,t,a){}})},updateComPage1:function(){var t=!0;for(var a in this.rules1)this.$refs.baseComForm.validateField(a,function(e){""!=e&&(this.$message.error(e,5e3),t=!1)}.bind(this));if(t){this.isLoading=!0;var n=this;if(""==this.company.contactName)return this.$message.error("请将相关信息补充完整");this.company.address=this.company.province+" "+this.company.city+" "+this.company.are+" "+this.xian,e.ajax({type:"PUT",url:i.default.UPDATE_COMINFORMATION,data:{companyAddress:n.company.address,email:n.company.email,companyLegal:n.company.companyLegal,emergencyContactName:n.company.emergencyContactName,emergencyContactPhone:n.company.emergencyContactPhone,contactName:n.company.contactName,companyName:n.company.companyName,licenseNumber:n.company.licenseNumber,licensePic:n.company.licensePic},success:function(){n.$message({message:"修改成功",type:"success"}),window.location.href="#/myplan"},dataType:"json"})}},updateComPage2:function(){var t=!0;for(var a in this.rules2)this.$refs.vertifyComForm.validateField(a,function(e){""!=e&&(this.$message.error(e,5e3),t=!1)}.bind(this));if(t){this.isLoading=!0;var n=this;e.ajax({type:"PUT",url:i.default.UPDATE_COMINFORDATA,data:{licenseNumber:n.company.licenseNumber,companyLegal:n.company.companyLegal,companyName:n.company.companyName,licensePic:n.company.licensePic},success:function(){n.$message({message:"修改成功",type:"success"}),window.location.href="#/myplan"},dataType:"json"})}},updateComPage3:function(){var t=!0;for(var a in this.rules3)this.$refs.phoneComForm.validateField(a,function(e){""!=e&&(this.$message.error(e,5e3),t=!1)}.bind(this));var n=this;e.ajax({type:"PUT",url:i.default.UPDATE_USERPHONE,data:{code:n.personPhoneCheck},success:function(){n.$message({message:"修改成功",type:"success"}),window.location.href="#/myplan"},error:function(){}})},comProvince:function(t){var a=this;this.company.city="",this.company.are="",this.xian="",this.company.province=t.name;var n=i.default.GET_PROVINCE+"?id="+t.id;e.ajax({type:"GEt",url:n,success:function(e){a.place.shi=e.data},dataType:"json"})},comCity:function(t){var a=this;this.company.are="",this.xian="",this.company.city=t.name;var n=i.default.GET_PROVINCE+"?id="+t.id;e.ajax({type:"GEt",url:n,success:function(e){a.place.qu=e.data},dataType:"json"})},comXian:function(e){his.xian=""},handleFileUploadSuccess:function(e,t,a){this.company.licensePic=URL.createObjectURL(t.raw),this.company.licensePhotoUrl=e.data[0].fullUrl},handleFileUploadFail:function(e,t,a){this.$message.error("附件上传失败，请重试")},beforeFileUpload:function(e){var t="image/jpeg"===e.type||"image/jpg"||"image/png",a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG/PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a}},data:function(){var e,t=this,a=function(e,t,a){var n=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;""!=t?n.test(t)?a():a(new Error("请邮箱格式错误")):a()},n=function(e,a,n){return t.company.emergencyContactPhone==t.company.newPhone?n(new Error(e.message)):void n()},o=function(e,a,n){return t.company.contactPhone==t.company.emergencyContactPhone?n(new Error(e.message)):void n()},r=function(e,t,a){return(0,u.default)(t)?void a():void a(new Error(e.message))},i=function(e,a,n){var o=/^1[34578]\d{9}$/;return o.test(t.company.newPhone)?void n():n(new Error(e.message))},l=function(e,a,n){return""==t.xian?n(new Error(e.message)):void n()},c=function(e,a,n){return""==t.company.licensePic?n(new Error(e.message)):void n()};return e={rules1:{emergencyContactName:[{required:!0,message:"请输入紧急联系人名字",trigger:"blur"},{min:2,message:"长度在 2 到 10 个字符",trigger:"blur"}],emergencyContactPhone:[{required:!0,message:"请输入紧急联系人电话",trigger:"blur"},{min:11,max:11,validator:o,message:"紧急联系人和联系人的号码不能一样",trigger:"blur"}],email:[{required:!0,message:"请再次输入邮箱",trigger:"blur"},{validator:a,trigger:"blur"}],companyAddress:[{required:!0,validator:l,message:"请输入详细地址",trigger:"blur"}],contactName:[{required:!0,message:"请填写单位联系人",trigger:"blur"}]},rules2:{licenseNumber:[{required:!0,validator:r,message:"请输入有效的社会统一信用代码",trigger:"blur"}],companyName:[{required:!0,message:"单位名称不能为空",trigger:"blur"}],companyLegal:[{required:!0,message:"公司法人不能为空",trigger:"blur"}],licensePic:[{required:!0,validator:c,message:"请上传营业执照",trigger:"blur"}]},rules3:{newPhone:[{required:!0,message:"请输入新手机号",trigger:"blur"},{min:11,max:11,validator:i,message:"请填写正确的手机号",trigger:"blur"},{validator:n,message:"新注册号码不能与紧急联系人号码一致",trigger:"blur"}],PhoneCheck:[{required:!0,message:"验证码不能为空",trigger:"blur"}]},imageUrl:"",fileUpload:"1",block:!1,timeback:60,tongyi:!0,personPhoneCheck:"",planTypeInputDisable:!1,activeName:"first",place:{sheng:"",shi:"",qu:""},xian:"",region:[{label:"飞行员证书",value:1}]},(0,s.default)(e,"xian",""),(0,s.default)(e,"company",{contactPhone:"",newPhone:"",emergencyContactName:"",emergencyContactPhone:"",address:"",email:"",city:"",province:"",are:"",licensePic:"",licensePhotoUrl:"",licenseNumber:"",companyAddress:"",companyName:"",companyLegal:""}),e},mounted:function(){var t=this;e.ajax({type:"GET",url:i.default.GET_UPDATEMESSAGE,success:function(e){t.company=c.default.util.extend(t.company,e.data),t.company.address=t.company.companyAddress.split(" "),t.company.province=t.company.address[0],t.company.city=t.company.address[1],t.company.are=t.company.address[2],t.xian=t.company.address[3],t.fileUpload=i.default.GET_UPLOAD,3==t.company.authStatus&&(t.planTypeInputDisable=!0),4==t.company.authStatus&&(t.block=!0)},dataType:"json"}),e.ajax({type:"GET",url:i.default.GET_PROVINCE,success:function(e){t.place.sheng=e.data},dataType:"json"})}}}).call(t,a(7))},519:function(e,t,a){t=e.exports=a(2)(),t.push([e.id,"[data-v-01bee330]{-webkit-transform-style:preserve-3d}.move_box[data-v-01bee330]{margin-top:34px}.plan-form-content[data-v-01bee330]{padding:0}","",{version:3,sources:["/./src/page/flyplan/updateCom.vue"],names:[],mappings:"AACA,kBAAmB,mCAAmC,CACrD,AACD,2BAA2B,eAAe,CACzC,AACD,oCAAoC,SAAS,CAC5C",file:"updateCom.vue",sourcesContent:["\n*[data-v-01bee330]{-webkit-transform-style:preserve-3d\n}\n.move_box[data-v-01bee330]{margin-top:34px\n}\n.plan-form-content[data-v-01bee330]{padding:0\n}"],sourceRoot:"webpack://"}])},574:function(e,t,a){var n=a(519);"string"==typeof n&&(n=[[e.id,n,""]]);a(3)(n,{});n.locals&&(e.exports=n.locals)},626:function(e,t,a){a(574);var n=a(5)(a(253),a(642),"data-v-01bee330",null);e.exports=n.exports},642:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"plan"},[a("div",{staticClass:"title clear",staticStyle:{padding:"15px 15px"}},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"企业信息编辑",name:"first"}},[a("div",{staticClass:"plan-form"},[a("el-form",{ref:"baseComForm",attrs:{"label-position":"left","label-width":"120px",model:e.company,rules:e.rules1}},[a("div",{staticClass:"plan-form-title"},[a("div",{staticClass:"devider"}),e._v(" "),a("p",{staticClass:"text"},[e._v("基本信息")])]),e._v(" "),a("div",{staticClass:"plan-form-content",staticStyle:{"padding-left":"20px"}},[a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"用户名"}},[e._v("\n\t\t\t\t\t\t\t\t\t\t"+e._s(e.company.userName)+"\n\t\t\t\t\t\t\t\t\t")]),e._v(" "),a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"单位名称"}},[e._v("\n\t\t\t\t\t\t\t\t\t\t"+e._s(e.company.companyName)+"\n\t\t\t\t\t\t\t\t\t")]),e._v(" "),a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"单位联系人",prop:"contactName"}},[a("el-input",{attrs:{disabled:e.planTypeInputDisable},model:{value:e.company.contactName,callback:function(t){e.company.contactName=t},expression:"company.contactName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"注册手机号码"}},[e._v("\n\t\t\t\t\t\t\t\t\t\t"+e._s(e.company.contactPhone)+"\n\t\t\t\t\t\t\t\t\t")]),e._v(" "),a("el-form-item",{staticStyle:{width:"60%"},attrs:{label:"单位地址",prop:"companyAddress"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择"},on:{input:e.comProvince},model:{value:e.company.province,callback:function(t){e.company.province=t},expression:"company.province"}},e._l(e.place.sheng,function(e){return a("el-option",{attrs:{label:e.name,value:e}})})),e._v(" "),a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择"},on:{input:e.comCity},model:{value:e.company.city,callback:function(t){e.company.city=t},expression:"company.city"}},e._l(e.place.shi,function(e){return a("el-option",{attrs:{label:e.name,value:e}})})),e._v(" "),a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择"},model:{value:e.company.are,callback:function(t){e.company.are=t},expression:"company.are"}},e._l(e.place.qu,function(e){return a("el-option",{attrs:{label:e.name,value:e.name}})})),e._v(" "),a("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea",rows:7,placeholder:"详细地址"},model:{value:e.xian,callback:function(t){e.xian=t},expression:"xian"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"公司邮箱",prop:"email"}},[a("el-input",{model:{value:e.company.email,callback:function(t){e.company.email=t},expression:"company.email"}})],1)],1),e._v(" "),a("div",{staticClass:"plan-form-title"},[a("div",{staticClass:"devider"}),e._v(" "),a("p",{staticClass:"text"},[e._v("紧急联系人")])]),e._v(" "),a("div",{staticClass:"plan-form-content",staticStyle:{"padding-left":"20px"}},[a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"姓名",prop:"emergencyContactName"}},[a("el-input",{model:{value:e.company.emergencyContactName,callback:function(t){e.company.emergencyContactName=t},expression:"company.emergencyContactName"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"手机号码",prop:"emergencyContactPhone"}},[a("el-input",{model:{value:e.company.emergencyContactPhone,callback:function(t){e.company.emergencyContactPhone=t},expression:"company.emergencyContactPhone"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"30px"}},[a("el-button",{staticStyle:{"margin-right":"8px",float:"left"},attrs:{type:"primary"},on:{click:e.updateComPage1}},[e._v("提交修改")]),e._v(" "),a("a",{attrs:{href:"#/myplan"}},[a("el-button",{staticClass:"left",staticStyle:{"z-index":"1000"}},[e._v("返回")])],1)],1)],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"认证信息",name:"second"}},[a("div",{staticClass:"plan-form"},[a("el-form",{ref:"vertifyComForm",attrs:{"label-position":"left","label-width":"120px",model:e.company,rules:e.rules2}},[a("div",{staticClass:"plan-form-title"},[a("div",{staticClass:"devider"}),e._v(" "),a("p",{staticClass:"text"},[e._v("认证信息")])]),e._v(" "),a("div",{staticClass:"plan-form-content",staticStyle:{"padding-left":"20px"}},[a("el-form-item",{attrs:{label:"认证状态"}},[1==e.company.authStatus?a("div",{staticStyle:{color:"red"}},[e._v("未认证")]):e._e(),e._v(" "),2==e.company.authStatus?a("div",{staticStyle:{color:"#3399ff"}},[e._v("待认证")]):e._e(),e._v(" "),3==e.company.authStatus?a("div",{staticStyle:{color:"green"}},[e._v("已认证")]):e._e(),e._v(" "),4==e.company.authStatus?a("div",{staticStyle:{color:"red"}},[e._v("认证失败")]):e._e()]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.block,expression:"block"}],staticStyle:{width:"50%"},attrs:{label:"失败原因"}},[a("div",{staticStyle:{color:"red"}},[e._v(e._s(e.company.reason))])]),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"单位名称",prop:"companyName"}},[a("el-input",{attrs:{disabled:e.planTypeInputDisable},model:{value:e.company.companyName,callback:function(t){e.company.companyName=t},expression:"company.companyName"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"公司法人",prop:"companyLegal"}},[a("el-input",{attrs:{disabled:e.planTypeInputDisable},model:{value:e.company.companyLegal,callback:function(t){e.company.companyLegal=t},expression:"company.companyLegal"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"社会统一信用代码",placeholder:"请输入执行编号",prop:"licenseNumber"}},[a("el-input",{attrs:{disabled:e.planTypeInputDisable},on:{blur:e.checklicenseNumber},model:{value:e.company.licenseNumber,callback:function(t){e.company.licenseNumber=t},expression:"company.licenseNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"营业执照",prop:"licensePic"}},[a("img",{staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.company.licensePic}}),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:e.planTypeInputDisable,action:e.fileUpload,"before-upload":e.beforeFileUpload,multiple:!1,"on-success":e.handleFileUploadSuccess,"on-error":e.handleFileUploadFail,"show-file-list":!1}},[a("el-button",{attrs:{size:"small",disabled:e.planTypeInputDisable}},[e._v("重新上传")])],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-right":"8px",float:"left"},attrs:{type:"primary",disabled:e.planTypeInputDisable},on:{click:e.updateComPage2}},[e._v("提交修改")]),e._v(" "),a("a",{attrs:{href:"#/myplan"}},[a("el-button",{staticClass:"left",staticStyle:{"z-index":"1000"}},[e._v("返回")])],1)],1)],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"修改注册手机",name:"third"}},[a("div",{staticClass:"plan-form"},[a("el-form",{ref:"phoneComForm",attrs:{"label-position":"left","label-width":"120px",model:e.company,rules:e.rules3}},[a("div",{staticClass:"plan-form-content"},[a("el-form-item",{attrs:{label:"联系人"}},[e._v("\n\t\t\t\t\t\t\t\t\t\t"+e._s(e.company.contactPhone)+"\n\t\t\t\t\t\t\t\t\t")])],1),e._v(" "),a("div",{staticClass:"plan-form-content"},[a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"新注册手机号",prop:"newPhone",placeholder:"验证短信将会发送到此手机上"}},[a("el-input",{model:{value:e.company.newPhone,callback:function(t){e.company.newPhone=t},expression:"company.newPhone"}})],1)],1),e._v(" "),a("div",{staticClass:"plan-form-content move_box"},[a("el-form-item",{staticStyle:{width:"40%"},attrs:{label:"验证码",prop:"PhoneCheck"}},[a("el-input",{model:{value:e.personPhoneCheck,callback:function(t){e.personPhoneCheck=t},expression:"personPhoneCheck"}})],1)],1),e._v(" "),a("el-button",{class:e.tongyi?"None":"Block",staticStyle:{top:"58px",left:"300px",position:"absolute"},attrs:{type:"primary"}},[e._v(e._s(e.timeback))]),e._v(" "),a("el-button",{class:e.tongyi?"Block":"None",staticStyle:{top:"58px",left:"290px",position:"absolute"},attrs:{type:"primary"},on:{click:e.checkTel}},[e._v("发送验证码")]),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-right":"8px",float:"left"},attrs:{type:"primary"},on:{click:e.updateComPage3}},[e._v("提交修改")]),e._v(" "),a("a",{attrs:{href:"#/myplan"}},[a("el-button",{staticClass:"left",staticStyle:{"z-index":"1000"}},[e._v("返回")])],1)],1)],1)],1)])],1)],1)])])},staticRenderFns:[]}}});